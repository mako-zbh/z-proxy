# ZProxy - 智能代理管理器

一款功能强大的 Chrome 浏览器代理插件，提供现代化的 UI 界面和完善的代理管理功能。

## 功能特性

### 核心功能
- **多代理管理** - 支持添加、编辑、删除多个代理服务器
- **一键切换** - 快速启用/禁用代理，简单方便
- **智能白名单** - 预置国内常用网站白名单，支持通配符域名匹配
- **代理认证** - 支持 HTTP/HTTPS/SOCKS5 代理的用户名密码认证
- **状态指示** - 实时显示代理连接状态（徽章显示 ON/OFF）
- **主题切换** - 支持深色/浅色主题切换
- **国际化** - 支持中文/英文界面切换
- **导入导出** - 支持白名单的导入导出功能

### 代理类型支持
- HTTP
- HTTPS
- SOCKS5

### 白名单功能
- **智能过滤** - 白名单中的域名自动绕过代理，直接连接
- **通配符支持** - 支持 `*.example.com` 格式的通配符域名
- **预置列表** - 预置国内常用网站白名单，包括百度、微软、阿里、腾讯等
- **批量操作** - 支持批量添加、导入导出白名单

## 安装方法

### 1. 生成图标文件

在浏览器中打开 `icon-generator.html` 文件，点击"下载所有图标"按钮，将下载的图标文件放入 `icons` 目录。

### 2. 加载插件到 Chrome

1. 打开 Chrome 浏览器
2. 在地址栏输入 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择 zproxy 项目文件夹
6. 插件安装完成！

## 使用指南

### 添加代理

1. 点击插件图标打开弹窗
2. 切换到"添加代理"标签页
3. 填写代理信息：
   - **名称**（可选）：方便识别的代理名称
   - **图标**：选择代理标识图标
   - **类型**：HTTP/HTTPS/SOCKS5
   - **主机**：服务器地址或域名
   - **端口**：代理服务器端口
   - **用户名/密码**（可选）：代理认证信息
4. 点击"添加代理"按钮

### 启用代理

1. 在"代理设置"标签页中选择要使用的代理
2. 点击代理卡片即可启用
3. 当卡片显示绿色且工具栏徽章显示 "ON" 时，代理已启用

### 编辑/删除代理

1. 在代理列表中，每个代理卡片右侧有两个按钮
2. 点击 ✏️ 按钮编辑代理配置
3. 点击 🗑️ 按钮删除代理（需确认）

### 禁用代理

1. 在代理列表顶部点击"关闭代理"选项
2. 或直接选择"关闭代理"卡片

### 配置白名单

1. 切换到"白名单"标签页
2. **批量添加**：在文本框中输入域名（每行一个），点击"添加"按钮
3. **移除域名**：在下拉列表中选择要移除的域名，点击"移除选中"
4. **清空全部**：点击"清空全部"按钮清空所有白名单
5. **导出白名单**：点击"导出白名单"将当前白名单导出为文本文件
6. **导入白名单**：点击"导入白名单"从文本文件批量导入域名

### 切换主题和语言

- 点击右上角的 🌗 按钮切换深色/浅色主题
- 点击右上角的 EN/中 按钮切换界面语言

## 项目结构

```
zproxy/
├── manifest.json          # 插件配置文件 (Manifest V3)
├── background.js          # 后台服务脚本
├── popup.html            # 弹窗界面
├── popup.css             # 弹窗样式
├── popup.js              # 弹窗逻辑
├── icon-generator.html   # 图标生成器
├── icons/                # 图标目录（需要生成）
│   ├── icon16.png
│   ├── icon32.png
│   ├── icon48.png
│   ├── icon128.png
│   ├── icon16-active.png
│   ├── icon32-active.png
│   ├── icon48-active.png
│   └── icon128-active.png
├── CLAUDE.md             # Claude Code 项目说明
└── README.md             # 说明文档
```

## 技术栈

- **Manifest V3** - Chrome 最新插件标准
- **Service Worker** - 后台服务，替代传统背景页面
- **原生 JavaScript** - 无依赖，轻量高效
- **Chrome Extension APIs**:
  - `chrome.proxy` - 代理设置管理
  - `chrome.storage.sync` - 配置存储和同步
  - `chrome.webRequest` - 请求拦截和认证
  - `chrome.downloads` - 文件下载（导出功能）

## 架构设计

### 代理配置模式

扩展支持两种代理模式：

1. **fixed_servers 模式**
   - 使用 `bypassList` 实现域名过滤
   - 适用于大多数代理类型

2. **pac_script 模式**
   - 动态生成 PAC JavaScript 脚本
   - 用于带认证的 SOCKS5 代理

### 状态管理

所有配置通过 `chrome.storage.sync` 同步存储：

```javascript
{
  isProxyEnabled: boolean,    // 代理启用状态
  currentProxy: number,       // 当前选中的代理索引
  proxies: [...],             // 代理列表
  whitelist: [...],           // 白名单域名列表
  theme: 'dark'|'light',      // 主题设置
  lang: 'zh'|'en'             // 语言设置
}
```

### 通信机制

- **popup → background**: 通过 `chrome.runtime.sendMessage()` 发送配置更新
- **background → proxy**: 通过 `chrome.proxy.settings.set()` 应用代理配置
- **存储同步**: 监听 `chrome.storage.onChanged` 自动应用配置变更

### 默认白名单

扩展预置了国内常用网站白名单，包括：
- 搜索引擎：百度、必应、搜狗
- 国内服务：微软、阿里、腾讯、京东、淘宝
- 社交媒体：微信、微博、知乎
- 视频网站：优酷、土豆、B站、爱奇艺

## 域名验证规则

白名单支持以下格式：
- 标准域名：`example.com`
- 通配符子域名：`*.example.com`
- IPv4 地址：`192.168.1.1`
- 特殊域名：`localhost`

## 开发说明

### 无构建系统

本项目使用纯原生 JavaScript，无需构建工具：
- 直接编辑源文件
- 在 `chrome://extensions/` 页面点击刷新按钮
- 更改立即生效

### 调试

- **后台脚本**: 在 `chrome://extensions/` 中点击"Service Worker"查看日志
- **弹窗**: 右键点击弹窗选择"检查"打开开发者工具

## 隐私说明

ZProxy 完全在本地运行，不收集任何用户数据：
- 所有代理配置存储在浏览器同步存储中
- 不会向任何第三方服务器发送数据
- 不会追踪用户浏览行为
- 白名单列表完全本地管理

## 安全建议

1. 仅使用可信的代理服务器
2. 定期更新代理密码
3. 不要在公共场所共享代理配置
4. 使用 HTTPS 或 SOCKS5 代理保护数据传输
5. 白名单配置可以减少敏感流量经过代理

## 常见问题

### Q: 代理启用后某些网站无法访问？
A: 将这些网站添加到白名单中，它们将绕过代理直接连接。

### Q: SOCKS5 代理需要认证怎么办？
A: 在添加代理时填写用户名和密码，扩展会自动处理认证。

### Q: 如何查看代理是否生效？
A: 工具栏图标上的绿色 "ON" 徽章表示代理已启用。

### Q: 配置会同步到其他设备吗？
A: 是的，使用 `chrome.storage.sync` 的配置会在同一账号的 Chrome 设备间同步。

## 许可证

MIT License - 详见 [LICENSE](LICENSE) 文件

## 贡献

欢迎提交 Issue 和 Pull Request！

## 更新日志

### v2.0.0
- 支持多代理管理
- 添加代理认证功能
- 支持主题切换
- 支持中英文界面
- 添加白名单导入导出功能
- 预置国内常用网站白名单

---

**免责声明**：本插件仅供学习和个人使用，请遵守当地法律法规。
